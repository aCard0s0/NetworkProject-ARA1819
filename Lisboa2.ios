conf t

interface Loopback0
    ip address 192.168.1.2 255.255.255.255
    ip ospf 1 area 0
    no shutdown

! Lisboa1 connection
interface FastEthernet0/0
    ip address 4.4.4.5 255.255.255.252
    no shutdown

! Madrid connection
interface FastEthernet1/1
    ip address 4.4.4.14 255.255.255.252
    no shutdown

! EthernetCore conncetion
interface FastEthernet0/1
    ip address 10.0.10.3 255.255.255.0
    ip ospf 1 area 0
    no shutdown

! Oeiras conncetion
interface FastEthernet1/0
    ip address 10.4.40.1 255.255.0.0
    ip ospf 1 area 0
    no shutdown

! DataCenterLisboa conncetion
interface FastEthernet2/0
    ip address 10.5.20.3 255.255.0.0
    ip ospf 1 area 0
    no shutdown

router ospf 100
    mpls traffic-eng router-id Loopback0
    mpls traffic-eng area 0
    redistribute static subnets
    !network 10.0.0.0 0.255.255.255 area 0
    
router bgp 1000
    ! Lisboa1
    neighbor 4.4.4.6 remote-as 40000
    ! Madrid
    neighbor 4.4.4.13 remote-as 20000
    ! Porto
    neighbor 192.168.1.1 remote-as 1000
    neighbor 192.168.1.1 update-source Loopback0
    ! Aveiro
    neighbor 192.168.1.3 remote-as 1000
    neighbor 192.168.1.3 update-source Loopback0
    ! Oeiras
    neighbor 192.168.1.4 remote-as 1000
    neighbor 192.168.1.4 update-source Loopback0

address-family ipv4 unicast
    network 192.168.1.128 mask 255.255.255.128
    neighbor 192.168.1.1 activate
    neighbor 192.168.1.1 next-hop-self
    neighbor 192.168.1.3 activate
    neighbor 192.168.1.3 next-hop-self
    neighbor 192.168.1.4 activate
    neighbor 192.168.1.4 next-hop-self
    exit-address-family

end